<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/AS.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/AS.jpg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"angelsnow1129.github","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="BUUCTF刷题记录期末了，都没办法在网上刷RE的题了。复习ing加油~~~~">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF-RE-0x05">
<meta property="og:url" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/index.html">
<meta property="og:site_name" content="AngelSnow 个人博客">
<meta property="og:description" content="BUUCTF刷题记录期末了，都没办法在网上刷RE的题了。复习ing加油~~~~">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://angelsnow1129.github/images/BUUCTF-RE-0x05/20210512205813.png">
<meta property="og:image" content="https://angelsnow1129.github/images/BUUCTF-RE-0x05/20210512205947.png">
<meta property="og:image" content="https://angelsnow1129.github/images/BUUCTF-RE-0x05/20210512210450.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/20210512210549.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/image-20210518204609499.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/image-20210518204649504.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/image-20210518204932548.png">
<meta property="og:image" content="https://angelsnow1129.github/images/BUUCTF-RE-0x05/image-20210524192045608.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/image-20210524191951091.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/image-20210524200837642.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/image-20210524201127943.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/20210513193140.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/20210513193512.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/20210513173953.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/20210513174514.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/20210513174602.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/20210513174926.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/20210513175505.png">
<meta property="og:image" content="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/images/BUUCTF-RE-0x05/20210513175843.png">
<meta property="article:published_time" content="2021-06-06T13:14:44.000Z">
<meta property="article:modified_time" content="2021-09-02T09:54:25.641Z">
<meta property="article:author" content="Snow">
<meta property="article:tag" content="算法, 程序开发, 生活, 操作系统, 信息安全">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://angelsnow1129.github/images/BUUCTF-RE-0x05/20210512205813.png">

<link rel="canonical" href="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>BUUCTF-RE-0x05 | AngelSnow 个人博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>


  <!--pjax：防止跳转页面音乐暂停-->
 <script src="https://cdn.jsdelivr.net/npm/[email protected]/pjax.js"></script>
 
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>


  
    <script src="/js/cursor/love.min.js"></script>
  

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">AngelSnow 个人博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">真，善，美</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/AS.jpg">
      <meta itemprop="name" content="Snow">
      <meta itemprop="description" content="Hope, Marvel, Youth.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AngelSnow 个人博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          BUUCTF-RE-0x05
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-06-06 21:14:44" itemprop="dateCreated datePublished" datetime="2021-06-06T21:14:44+08:00">2021-06-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-09-02 17:54:25" itemprop="dateModified" datetime="2021-09-02T17:54:25+08:00">2021-09-02</time>
              </span>

          
            <span class="post-meta-item" title="热度" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="eye"></i>
              </span>
              <span class="post-meta-item-text">热度：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="BUUCTF刷题记录"><a href="#BUUCTF刷题记录" class="headerlink" title="BUUCTF刷题记录"></a>BUUCTF刷题记录</h1><p>期末了，都没办法在网上刷RE的题了。复习ing加油~~~~</p>
<span id="more"></span>

<h2 id="ACTF新生赛2020-rome"><a href="#ACTF新生赛2020-rome" class="headerlink" title="[ACTF新生赛2020]rome"></a>[ACTF新生赛2020]rome</h2><h3 id="题目详情"><a href="#题目详情" class="headerlink" title="题目详情"></a>题目详情</h3><p><img src="/images/BUUCTF-RE-0x05/20210512205813.png" alt="image-20210512205804991"></p>
<p><a target="_blank" rel="noopener" href="https://files.buuoj.cn/files/588c32051222b5dba864ddeb07c44e74/attachment.tar?token=eyJ1c2VyX2lkIjoxOTIwMiwidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6MTY4M30.YJvQ1A.1ZJW8PXxcPyrojSnlv90-89sgtY">下载下来</a> </p>
<h3 id="查壳"><a href="#查壳" class="headerlink" title="查壳"></a>查壳</h3><p><img src="/images/BUUCTF-RE-0x05/20210512205947.png" alt="image-20210512205945862"></p>
<p>没壳，先放入IDA32。然后在F5之后，直接进入字符串搜索，发现正确的地方，然后跳转过去。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v1[<span class="number">4</span>]; <span class="comment">// [esp+14h] [ebp-44h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v2; <span class="comment">// [esp+24h] [ebp-34h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v3; <span class="comment">// [esp+25h] [ebp-33h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v4; <span class="comment">// [esp+26h] [ebp-32h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v5; <span class="comment">// [esp+27h] [ebp-31h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v6; <span class="comment">// [esp+28h] [ebp-30h]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [esp+29h] [ebp-2Fh]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [esp+2Dh] [ebp-2Bh]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [esp+31h] [ebp-27h]</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [esp+35h] [ebp-23h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v11; <span class="comment">// [esp+39h] [ebp-1Fh]</span></span><br><span class="line">  <span class="keyword">char</span> v12[<span class="number">29</span>]; <span class="comment">// [esp+3Bh] [ebp-1Dh] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(v12, <span class="string">&quot;Qsw3sj_lz4_Ujw@l&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please input:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;v2);</span><br><span class="line">  result = v2;</span><br><span class="line">  <span class="keyword">if</span> ( v2 == <span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = v3;</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="string">&#x27;C&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      result = v4;</span><br><span class="line">      <span class="keyword">if</span> ( v4 == <span class="string">&#x27;T&#x27;</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        result = v5;</span><br><span class="line">        <span class="keyword">if</span> ( v5 == <span class="string">&#x27;F&#x27;</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          result = v6;</span><br><span class="line">          <span class="keyword">if</span> ( v6 == <span class="string">&#x27;&#123;&#x27;</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            result = v11;</span><br><span class="line">            <span class="keyword">if</span> ( v11 == <span class="string">&#x27;&#125;&#x27;</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              v1[<span class="number">0</span>] = v7;</span><br><span class="line">              v1[<span class="number">1</span>] = v8;</span><br><span class="line">              v1[<span class="number">2</span>] = v9;</span><br><span class="line">              v1[<span class="number">3</span>] = v10;</span><br><span class="line">              *(_DWORD *)&amp;v12[<span class="number">17</span>] = <span class="number">0</span>;</span><br><span class="line">              <span class="keyword">while</span> ( *(<span class="keyword">int</span> *)&amp;v12[<span class="number">17</span>] &lt;= <span class="number">15</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">if</span> ( *((<span class="keyword">char</span> *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) &gt; <span class="number">64</span> &amp;&amp; *((<span class="keyword">char</span> *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) &lt;= <span class="string">&#x27;Z&#x27;</span> )</span><br><span class="line">                  *((_BYTE *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) = (*((<span class="keyword">char</span> *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) - <span class="number">51</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">                <span class="keyword">if</span> ( *((<span class="keyword">char</span> *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) &gt; <span class="number">96</span> &amp;&amp; *((<span class="keyword">char</span> *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) &lt;= <span class="number">122</span> )</span><br><span class="line">                  *((_BYTE *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) = (*((<span class="keyword">char</span> *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) - <span class="number">79</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">                ++*(_DWORD *)&amp;v12[<span class="number">17</span>];</span><br><span class="line">              &#125;</span><br><span class="line">              *(_DWORD *)&amp;v12[<span class="number">17</span>] = <span class="number">0</span>;</span><br><span class="line">              <span class="keyword">while</span> ( *(<span class="keyword">int</span> *)&amp;v12[<span class="number">17</span>] &lt;= <span class="number">15</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                result = (<span class="keyword">unsigned</span> __int8)v12[*(_DWORD *)&amp;v12[<span class="number">17</span>]];</span><br><span class="line">                <span class="keyword">if</span> ( *((_BYTE *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) != (_BYTE)result )</span><br><span class="line">                  <span class="keyword">return</span> result;</span><br><span class="line">                ++*(_DWORD *)&amp;v12[<span class="number">17</span>];</span><br><span class="line">              &#125;</span><br><span class="line">              result = <span class="built_in">printf</span>(<span class="string">&quot;You are correct!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后粗略读下来还是读懂了，然后就是把这个简单的算法逆向应该就可以了。</p>
<h3 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h3><p><img src="/images/BUUCTF-RE-0x05/20210512210450.png" alt="image-20210512210449070"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">v12 =<span class="string">&quot;Qsw3sj_lz4_Ujw@l&quot;</span></span><br><span class="line">v12list=<span class="built_in">list</span>(v12)</span><br><span class="line">v12l =[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v12)):</span><br><span class="line">    v12l.append(<span class="built_in">ord</span>(v12list[i]))</span><br><span class="line"><span class="comment"># v12l = [81,115,119,51,115,106,95,108,122,52,95,85,106,119,64,108]</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">127</span>):</span><br><span class="line">        z = i</span><br><span class="line">        <span class="keyword">if</span> i &gt; <span class="number">64</span> <span class="keyword">and</span> i &lt;= <span class="number">90</span>:</span><br><span class="line">            i = (i-<span class="number">51</span>)%<span class="number">26</span> + <span class="number">65</span></span><br><span class="line">        <span class="keyword">if</span> i &gt; <span class="number">96</span> <span class="keyword">and</span> i &lt;= <span class="number">122</span>:</span><br><span class="line">            i = (i-<span class="number">79</span>)%<span class="number">26</span> + <span class="number">97</span></span><br><span class="line">        <span class="keyword">if</span>(i == v12l[k]):</span><br><span class="line">            flag += <span class="built_in">chr</span>(z)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;&quot;</span>+flag+<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="comment"># flag&#123;Cae3ar_th4_Gre@t&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">flag</span>&#123;Cae<span class="number">3</span>ar_th<span class="number">4</span>_Gre@t&#125;</span><br></pre></td></tr></table></figure>

<p><img src="./images/BUUCTF-RE-0x05/20210512210549.png" alt="image-20210512210548038"></p>
<h2 id="FlareOn4-login"><a href="#FlareOn4-login" class="headerlink" title="[FlareOn4]login"></a>[FlareOn4]login</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p><img src="./images/BUUCTF-RE-0x05/image-20210518204609499.png" alt="image-20210518204609499"></p>
<p>下载后解压后发现是个网页。</p>
<p><img src="./images/BUUCTF-RE-0x05/image-20210518204649504.png" alt="image-20210518204649504"></p>
<p>文本文档没有什么重要的信息。所以我们打开这个，用的是    ==sublimeText3==  打开的，然后看见了这个简单的代码，所以就可以做出了。</p>
<h3 id="login-html-源码"><a href="#login-html-源码" class="headerlink" title="login.html 源码"></a>login.html 源码</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">Html</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>FLARE On 2017<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;flag&quot;</span> <span class="attr">id</span>=<span class="string">&quot;flag&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Enter the flag&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&quot;prompt&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Click to check the flag&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.getElementById(<span class="string">&quot;prompt&quot;</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> flag = <span class="built_in">document</span>.getElementById(<span class="string">&quot;flag&quot;</span>).value;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> rotFlag = flag.replace(<span class="regexp">/[a-zA-Z]/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">c</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">String</span>.fromCharCode((c &lt;= <span class="string">&quot;Z&quot;</span> ? <span class="number">90</span> : <span class="number">122</span>) &gt;= (c = c.charCodeAt(<span class="number">0</span>) + <span class="number">13</span>) ? c : c - <span class="number">26</span>);&#125;);</span></span><br><span class="line">               </span><br><span class="line"><span class="javascript">                <span class="keyword">if</span> (<span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span> == rotFlag) &#123;</span></span><br><span class="line"><span class="javascript">                    alert(<span class="string">&quot;Correct flag!&quot;</span>);</span></span><br><span class="line"><span class="javascript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">                    alert(<span class="string">&quot;Incorrect flag, rot again&quot;</span>);</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="./images/BUUCTF-RE-0x05/image-20210518204932548.png" alt="image-20210518204932548"></p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>代码的意思是，将输入方框里面的内容进行替换，然后判断能否等于所比较的内容。而大概的方法是通过13位的替换的方法，只替换字母。</p>
<p>然后在网上可以找到叫做 ==rot13== 的回转13位密码置换的方法。</p>
<p>于是就这个思路写简单的算法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> =<span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">string=<span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">string2=string.upper()</span><br><span class="line">string+=string2</span><br><span class="line">strlist = <span class="built_in">list</span>(string)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> string:</span><br><span class="line">        temp = string.find(i)</span><br><span class="line">        <span class="keyword">if</span>(temp%<span class="number">26</span>-<span class="number">13</span>&lt;<span class="number">0</span>):</span><br><span class="line">            temp+=<span class="number">13</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            temp-=<span class="number">13</span></span><br><span class="line">        flag += strlist[temp]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        temp=<span class="built_in">ord</span>(i)</span><br><span class="line">        flag+=i</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;&quot;</span>+flag+<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="comment"># flag&#123;ClientSideLoginsAreEasy@flare-on.com&#125;</span></span><br></pre></td></tr></table></figure>

<p>思路就是将每一个在另一个表中去寻找，然后如果求26的余减去13为负，说明原来的时候也是变过的，所以就不需要改变。</p>
<h3 id="flag-1"><a href="#flag-1" class="headerlink" title="flag"></a>flag</h3><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag：</span><br><span class="line">flag&#123;ClientSideLoginsAreEasy@flare-<span class="literal">on</span>.com&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">感觉这道题很有意思，很简单的一个算法。</span><br><span class="line">像是一个凯撒加密位移了13的密码。</span><br></pre></td></tr></table></figure>

<h2 id="GUET-CTF2019-re"><a href="#GUET-CTF2019-re" class="headerlink" title="[GUET-CTF2019]re"></a>[GUET-CTF2019]re</h2><h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p><img src="/images/BUUCTF-RE-0x05/image-20210524192045608.png" alt="image-20210524192045608"></p>
<h3 id="查壳-1"><a href="#查壳-1" class="headerlink" title="查壳"></a>查壳</h3><p>发现是upx的压缩壳，而且是elf文件，所以就用upx解压了。</p>
<p><img src="./images/BUUCTF-RE-0x05/image-20210524191951091.png" alt="image-20210524191951091"></p>
<p>下一步，拖入IDA进行分析一下。</p>
<p>进入主函数看看：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_400E28</span><span class="params">(__int64 a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3, <span class="keyword">int</span> a4, <span class="keyword">int</span> a5, <span class="keyword">int</span> a6)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// er8</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// er9</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+0h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v12; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">sub_40F950</span>((<span class="keyword">unsigned</span> <span class="keyword">int</span>)<span class="string">&quot;input your flag:&quot;</span>, a2, a3, a4, a5, a6, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">sub_40FA80</span>((<span class="keyword">unsigned</span> <span class="keyword">int</span>)<span class="string">&quot;%s&quot;</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;v11, v6, v7, v8, v9, v11);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)<span class="built_in">sub_4009AE</span>(&amp;v11) )</span><br><span class="line">    <span class="built_in">sub_410350</span>(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">sub_410350</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">  result = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(<span class="number">0x28</span>u) != v12 )</span><br><span class="line">    <span class="built_in">sub_443550</span>();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>大致可以看出这个逆向挺简单，就是将输入的进行判断一下。</p>
<p>进入判断那个函数</p>
<p> ==(unsigned int)sub_4009AE(&amp;v11)== </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_BOOL8 __fastcall <span class="title">sub_4009AE</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">1629056</span> * *a1 != <span class="number">166163712</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6771600</span> * a1[<span class="number">1</span>] != <span class="number">731332800</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3682944</span> * a1[<span class="number">2</span>] != <span class="number">357245568</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">10431000</span> * a1[<span class="number">3</span>] != <span class="number">1074393000</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3977328</span> * a1[<span class="number">4</span>] != <span class="number">489211344</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5138336</span> * a1[<span class="number">5</span>] != <span class="number">518971936</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7532250</span> * a1[<span class="number">7</span>] != <span class="number">406741500</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5551632</span> * a1[<span class="number">8</span>] != <span class="number">294236496</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3409728</span> * a1[<span class="number">9</span>] != <span class="number">177305856</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">13013670</span> * a1[<span class="number">10</span>] != <span class="number">650683500</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6088797</span> * a1[<span class="number">11</span>] != <span class="number">298351053</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7884663</span> * a1[<span class="number">12</span>] != <span class="number">386348487</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8944053</span> * a1[<span class="number">13</span>] != <span class="number">438258597</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5198490</span> * a1[<span class="number">14</span>] != <span class="number">249527520</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">4544518</span> * a1[<span class="number">15</span>] != <span class="number">445362764</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3645600</span> * a1[<span class="number">17</span>] != <span class="number">174988800</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">10115280</span> * a1[<span class="number">16</span>] != <span class="number">981182160</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">9667504</span> * a1[<span class="number">18</span>] != <span class="number">493042704</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5364450</span> * a1[<span class="number">19</span>] != <span class="number">257493600</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">13464540</span> * a1[<span class="number">20</span>] != <span class="number">767478780</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5488432</span> * a1[<span class="number">21</span>] != <span class="number">312840624</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">14479500</span> * a1[<span class="number">22</span>] != <span class="number">1404511500</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6451830</span> * a1[<span class="number">23</span>] != <span class="number">316139670</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6252576</span> * a1[<span class="number">24</span>] != <span class="number">619005024</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7763364</span> * a1[<span class="number">25</span>] != <span class="number">372641472</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7327320</span> * a1[<span class="number">26</span>] != <span class="number">373693320</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8741520</span> * a1[<span class="number">27</span>] != <span class="number">498266640</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8871876</span> * a1[<span class="number">28</span>] != <span class="number">452465676</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">4086720</span> * a1[<span class="number">29</span>] != <span class="number">208422720</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">9374400</span> * a1[<span class="number">30</span>] == <span class="number">515592000</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">5759124</span> * a1[<span class="number">31</span>] == <span class="number">719890500</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个将每一个数值进行算数后进行比较。所以将这些数值取出来，然后逆向就行了。</p>
<p>不过发现少了a1[6] 第七个不见了。</p>
<p>逆向出来的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># [GUET-CTF2019]re</span></span><br><span class="line"></span><br><span class="line">list1 =[ <span class="number">166163712</span>,<span class="number">731332800</span>,<span class="number">357245568</span>,<span class="number">1074393000</span>,<span class="number">489211344</span>,<span class="number">518971936</span>,<span class="number">406741500</span>,<span class="number">294236496</span>,<span class="number">177305856</span>,</span><br><span class="line">         <span class="number">650683500</span>,<span class="number">298351053</span></span><br><span class="line">         ,<span class="number">386348487</span>,<span class="number">438258597</span>,<span class="number">249527520</span>,<span class="number">445362764</span>,<span class="number">174988800</span>,<span class="number">981182160</span>,<span class="number">493042704</span>,<span class="number">257493600</span>, <span class="number">767478780</span></span><br><span class="line">         ,<span class="number">312840624</span>, <span class="number">1404511500</span> ,<span class="number">316139670</span>,<span class="number">619005024</span>, <span class="number">372641472</span>,<span class="number">373693320</span>,<span class="number">498266640</span>, <span class="number">452465676</span>,</span><br><span class="line">         <span class="number">208422720</span>,<span class="number">515592000</span>,<span class="number">719890500</span> ]</span><br><span class="line">list2 =[   <span class="number">1629056</span>,<span class="number">6771600</span>,<span class="number">3682944</span>,<span class="number">10431000</span>,<span class="number">3977328</span>,<span class="number">5138336</span>,<span class="number">7532250</span>,<span class="number">5551632</span>,<span class="number">3409728</span>,<span class="number">13013670</span>,<span class="number">6088797</span></span><br><span class="line">           ,<span class="number">7884663</span>,<span class="number">8944053</span>,<span class="number">5198490</span>,<span class="number">4544518</span>,<span class="number">3645600</span>,<span class="number">10115280</span>,<span class="number">9667504</span>,<span class="number">5364450</span>,<span class="number">13464540</span>,<span class="number">5488432</span>,<span class="number">14479500</span>,</span><br><span class="line">        <span class="number">6451830</span>,<span class="number">6252576</span>,<span class="number">7763364</span>,<span class="number">7327320</span>,<span class="number">8741520</span>,<span class="number">8871876</span>,<span class="number">4086720</span>,<span class="number">9374400</span>,<span class="number">5759124</span> ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">list</span> =[]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(list1),<span class="built_in">len</span>(list2))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(list1)):</span><br><span class="line">    <span class="comment"># if i==6:</span></span><br><span class="line">    <span class="comment">#     temp=&#x27;~&#x27;</span></span><br><span class="line">    <span class="comment"># else:</span></span><br><span class="line">    temp=list1[i]/list2[i]</span><br><span class="line">    temp = <span class="built_in">int</span>(temp)</span><br><span class="line">    <span class="built_in">list</span>.append(temp)</span><br><span class="line">    flag+=<span class="built_in">chr</span>(temp)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;e65421110b0a3099a1c039337&#125;</span></span><br></pre></td></tr></table></figure>

<p>所以flag就是</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;e?<span class="number">65421110</span>b0a3099a<span class="number">1c039337</span>&#125;</span><br><span class="line">然后就是一个一个试</span><br></pre></td></tr></table></figure>

<p><img src="./images/BUUCTF-RE-0x05/image-20210524200837642.png" alt="image-20210524200837642"></p>
<p>看了一圈发现自己错的竟然是16和17位的位置换了。。。</p>
<p>所以改下原来的表。</p>
<h3 id="改后flag"><a href="#改后flag" class="headerlink" title="改后flag"></a>改后flag</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># [GUET-CTF2019]re</span></span><br><span class="line"></span><br><span class="line">list1 =[ <span class="number">166163712</span>,<span class="number">731332800</span>,<span class="number">357245568</span>,<span class="number">1074393000</span>,<span class="number">489211344</span>,<span class="number">518971936</span>,<span class="number">406741500</span>,<span class="number">294236496</span>,<span class="number">177305856</span>,</span><br><span class="line">         <span class="number">650683500</span>,<span class="number">298351053</span> ,<span class="number">386348487</span>,<span class="number">438258597</span>,<span class="number">249527520</span>,<span class="number">445362764</span>,<span class="number">981182160</span>,<span class="number">174988800</span>,<span class="number">493042704</span>,</span><br><span class="line">         <span class="number">257493600</span>, <span class="number">767478780</span>   ,<span class="number">312840624</span>, <span class="number">1404511500</span> ,<span class="number">316139670</span>,<span class="number">619005024</span>, <span class="number">372641472</span>,<span class="number">373693320</span>,</span><br><span class="line">         <span class="number">498266640</span>, <span class="number">452465676</span>, <span class="number">208422720</span>,<span class="number">515592000</span>,<span class="number">719890500</span> ]</span><br><span class="line">list2 =[   <span class="number">1629056</span>,<span class="number">6771600</span>,<span class="number">3682944</span>,<span class="number">10431000</span>,<span class="number">3977328</span>,<span class="number">5138336</span>,<span class="number">7532250</span>,<span class="number">5551632</span>,<span class="number">3409728</span>,<span class="number">13013670</span>,<span class="number">6088797</span></span><br><span class="line">           ,<span class="number">7884663</span>,<span class="number">8944053</span>,<span class="number">5198490</span>,<span class="number">4544518</span>,<span class="number">10115280</span>,<span class="number">3645600</span>,<span class="number">9667504</span>,<span class="number">5364450</span>,<span class="number">13464540</span>,<span class="number">5488432</span>,<span class="number">14479500</span>,</span><br><span class="line">        <span class="number">6451830</span>,<span class="number">6252576</span>,<span class="number">7763364</span>,<span class="number">7327320</span>,<span class="number">8741520</span>,<span class="number">8871876</span>,<span class="number">4086720</span>,<span class="number">9374400</span>,<span class="number">5759124</span> ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">list</span> =[]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(list1),<span class="built_in">len</span>(list2))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(list1)):</span><br><span class="line">    <span class="comment"># if i==6:</span></span><br><span class="line">    <span class="comment">#     temp=&#x27;~&#x27;</span></span><br><span class="line">    <span class="comment"># else:</span></span><br><span class="line">    temp=list1[i]/list2[i]</span><br><span class="line">    temp = <span class="built_in">int</span>(temp)</span><br><span class="line">    <span class="built_in">list</span>.append(temp)</span><br><span class="line">    flag+=<span class="built_in">chr</span>(temp)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;e165421110ba03099a1c039337&#125;  # flag</span></span><br><span class="line"><span class="comment"># flag&#123;e 65421110b0a3099a1c039337&#125;</span></span><br><span class="line"><span class="comment"># flag&#123;e 65421110ba03099a1c039337&#125;  改后</span></span><br></pre></td></tr></table></figure>

<p><img src="./images/BUUCTF-RE-0x05/image-20210524201127943.png" alt="image-20210524201127943"></p>
<h2 id="Android模拟器检测常用方法"><a href="#Android模拟器检测常用方法" class="headerlink" title="Android模拟器检测常用方法"></a>Android模拟器检测常用方法</h2><p>江城的程序员大叔 </p>
<p>分类专栏： 你好，Android 文章标签： android android模拟器 防作弊 虚拟机 模拟器检测<br>版权<br>在Android开发过程中，防作弊一直是老生常谈的问题，而模拟器的检测往往是防作弊中的重要一环，接下来有关于模拟器的检测方法，和大家进行一个简单的分享。</p>
<!--more-->

<h3 id="1-传统的检测方法。"><a href="#1-传统的检测方法。" class="headerlink" title="1.传统的检测方法。"></a>1.传统的检测方法。</h3><p>传统的检测方法主要是对模拟器的IMSI、IDS、默认文件等几个方面进行检测。</p>
<h4 id="（1）默认号码："><a href="#（1）默认号码：" class="headerlink" title="（1）默认号码："></a>（1）默认号码：</h4><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">String</span>[] known_numbers = &#123;<span class="string">&quot;15555215554&quot;</span>, <span class="string">&quot;15555215556&quot;</span>,</span><br><span class="line">            <span class="string">&quot;15555215558&quot;</span>, <span class="string">&quot;15555215560&quot;</span>, <span class="string">&quot;15555215562&quot;</span>, <span class="string">&quot;15555215564&quot;</span>,</span><br><span class="line">            <span class="string">&quot;15555215566&quot;</span>, <span class="string">&quot;15555215568&quot;</span>, <span class="string">&quot;15555215570&quot;</span>, <span class="string">&quot;15555215572&quot;</span>,</span><br><span class="line">            <span class="string">&quot;15555215574&quot;</span>, <span class="string">&quot;15555215576&quot;</span>, <span class="string">&quot;15555215578&quot;</span>, <span class="string">&quot;15555215580&quot;</span>,</span><br><span class="line">            <span class="string">&quot;15555215582&quot;</span>, <span class="string">&quot;15555215584&quot;</span>&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="（2）默认ID："><a href="#（2）默认ID：" class="headerlink" title="（2）默认ID："></a>（2）默认ID：</h4><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">String</span>[] known_device_ids = &#123;<span class="string">&quot;000000000000000&quot;</span>&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="（3）默认IMSI："><a href="#（3）默认IMSI：" class="headerlink" title="（3）默认IMSI："></a>（3）默认IMSI：</h4><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">String</span>[] known_imsi_ids = &#123;<span class="string">&quot;310260000000000&quot;</span>&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="（4）默认文件路径："><a href="#（4）默认文件路径：" class="headerlink" title="（4）默认文件路径："></a>（4）默认文件路径：</h4><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">String</span>[] known_files = &#123;</span><br><span class="line">            <span class="string">&quot;/system/lib/libc_malloc_debug_qemu.so&quot;</span>,</span><br><span class="line">            <span class="string">&quot;/sys/qemu_trace&quot;</span>,</span><br><span class="line">            <span class="string">&quot;/system/bin/qemu-props&quot;</span>&#125;;</span><br></pre></td></tr></table></figure>

<p>在得知了这些信息后，只需在运行时进行检测，如果检测结果和默认值吻合，那么检测设备便是模拟器。不过随着防反作弊技术的迭代，现在很多模拟器都可以改变这些值来逃避检测，所以上述传统方法在很多时候未曾达到开发者的预期效果。</p>
<h3 id="2-基于模拟器cpu信息的检测。"><a href="#2-基于模拟器cpu信息的检测。" class="headerlink" title="2.基于模拟器cpu信息的检测。"></a>2.基于模拟器cpu信息的检测。</h3><p>成功率相较于传统方法，有了更高的成功率。</p>
<p>cpu信息检测主要是在cpu信息看看是否包含intel、amd等字段，很多模拟器目前对于cpu信息还无法进行模拟。</p>
<h4 id="（1）读取cpu信息："><a href="#（1）读取cpu信息：" class="headerlink" title="（1）读取cpu信息："></a>（1）读取cpu信息：</h4><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> <span class="title">readCpuInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">String</span> result = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">String</span>[] args = &#123;<span class="string">&quot;/system/bin/cat&quot;</span>, <span class="string">&quot;/proc/cpuinfo&quot;</span>&#125;;</span><br><span class="line">            ProcessBuilder cmd = <span class="keyword">new</span> <span class="built_in">ProcessBuilder</span>(args);</span><br><span class="line"></span><br><span class="line">​        <span class="built_in">Process</span> process = cmd.<span class="built_in">start</span>();</span><br><span class="line">​        StringBuffer sb = <span class="keyword">new</span> <span class="built_in">StringBuffer</span>();</span><br><span class="line">​        <span class="keyword">String</span> readLine = <span class="string">&quot;&quot;</span>;</span><br><span class="line">​        BufferedReader responseReader = <span class="keyword">new</span> <span class="built_in">BufferedReader</span>(<span class="keyword">new</span> <span class="built_in">InputStreamReader</span>(process.<span class="built_in">getInputStream</span>(), <span class="string">&quot;utf-8&quot;</span>));</span><br><span class="line">​        <span class="keyword">while</span> ((readLine = responseReader.<span class="built_in">readLine</span>()) != null) &#123;</span><br><span class="line">​            sb.<span class="built_in">append</span>(readLine);</span><br><span class="line">​        &#125;</span><br><span class="line">​        responseReader.<span class="built_in">close</span>();</span><br><span class="line">​        result = sb.<span class="built_in">toString</span>().<span class="built_in">toLowerCase</span>();</span><br><span class="line">​    &#125; <span class="built_in"><span class="keyword">catch</span></span> (IOException ex) &#123;</span><br><span class="line">​    &#125;</span><br><span class="line">​    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="（2）进行判定："><a href="#（2）进行判定：" class="headerlink" title="（2）进行判定："></a>（2）进行判定：</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String cpuInfo = readCpuInfo();</span><br><span class="line"><span class="keyword">if</span> ((cpuInfo.<span class="keyword">contains</span>(<span class="string">&quot;intel&quot;</span>) || cpuInfo.<span class="keyword">contains</span>(<span class="string">&quot;amd&quot;</span>))) &#123;<span class="literal">return</span> <span class="literal">true</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>类似的还有</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">String</span>[] blockList = <span class="string">&quot;google_sdk,sdk,sdk_x86,vbox86p&quot;</span>.<span class="built_in">split</span>(<span class="string">&quot;,&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>原理相同。</p>
<h3 id="3-关键路径检测特定模拟器检测"><a href="#3-关键路径检测特定模拟器检测" class="headerlink" title="3.关键路径检测特定模拟器检测"></a>3.关键路径检测特定模拟器检测</h3><p>前面2个方法在很大程度上已经可以鉴定出很多模拟器了，但是对于某些在反防作弊上同样热爱的模拟器，需要特定的检测方法。</p>
<p><strong>bluestacks</strong>成功躲避了前两种检测方法，所以在这里给予其VIP的待遇。</p>
<p>以下是总结出来的一些bluestacks的关键路径：</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">String</span>[] known_bluestacks = &#123;<span class="string">&quot;/data/app/com.bluestacks.appmart-1.apk&quot;</span>, <span class="string">&quot;/data/app/com.bluestacks.BstCommandProcessor-1.apk&quot;</span>,</span><br><span class="line">           <span class="string">&quot;/data/app/com.bluestacks.help-1.apk&quot;</span>, <span class="string">&quot;/data/app/com.bluestacks.home-1.apk&quot;</span>, <span class="string">&quot;/data/app/com.bluestacks.s2p-1.apk&quot;</span>,</span><br><span class="line">           <span class="string">&quot;/data/app/com.bluestacks.searchapp-1.apk&quot;</span>, <span class="string">&quot;/data/bluestacks.prop&quot;</span>, <span class="string">&quot;/data/data/com.androVM.vmconfig&quot;</span>,</span><br><span class="line">           <span class="string">&quot;/data/data/com.bluestacks.accelerometerui&quot;</span>, <span class="string">&quot;/data/data/com.bluestacks.appfinder&quot;</span>, <span class="string">&quot;/data/data/com.bluestacks.appmart&quot;</span>,</span><br><span class="line">           <span class="string">&quot;/data/data/com.bluestacks.appsettings&quot;</span>, <span class="string">&quot;/data/data/com.bluestacks.BstCommandProcessor&quot;</span>, <span class="string">&quot;/data/data/com.bluestacks.bstfolder&quot;</span>,</span><br><span class="line">           <span class="string">&quot;/data/data/com.bluestacks.help&quot;</span>, <span class="string">&quot;/data/data/com.bluestacks.home&quot;</span>, <span class="string">&quot;/data/data/com.bluestacks.s2p&quot;</span>, <span class="string">&quot;/data/data/com.bluestacks.searchapp&quot;</span>,</span><br><span class="line">           <span class="string">&quot;/data/data/com.bluestacks.settings&quot;</span>, <span class="string">&quot;/data/data/com.bluestacks.setup&quot;</span>, <span class="string">&quot;/data/data/com.bluestacks.spotlight&quot;</span>, <span class="string">&quot;/mnt/prebundledapps/bluestacks.prop.orig&quot;</span></span><br><span class="line">   &#125;;</span><br></pre></td></tr></table></figure>

<h4 id="检测方法："><a href="#检测方法：" class="headerlink" title="检测方法："></a>检测方法：</h4><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">checkBlueStacksFiles</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; known_bluestacks.length; i++) &#123;</span><br><span class="line">            <span class="keyword">String</span> file_name = known_bluestacks[i];</span><br><span class="line">            <span class="built_in">File</span> qemu_file = <span class="keyword">new</span> <span class="built_in"><span class="built_in">File</span></span>(file_name);</span><br><span class="line">            <span class="keyword">if</span> (qemu_file.<span class="built_in">exists</span>()) &#123;</span><br><span class="line">                FkLog.<span class="built_in">e</span>(<span class="string">&quot;Result : Find BlueStacks Files!&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        FkLog.<span class="built_in">e</span>(<span class="string">&quot;Result : Not Find BlueStacks Files!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这种基于关键路径的检测，便可以成功的检测出bluestacks。</p>
<h3 id="4-模拟器检测新思路"><a href="#4-模拟器检测新思路" class="headerlink" title="4.模拟器检测新思路"></a>4.模拟器检测新思路</h3><p>模拟器检测与模拟器反检测都在不断的更新迭代中，无法确保哪一种方法会永垂不朽，在这里分享下新的思路。</p>
<p>电池信息检测</p>
<p>可以从电池的温度和电量等信息入手，检测温度在使用过程中是否一直保持不变、或者是电量一直是固定值并且不是百分之百等等。</p>
<p>亲测可以鉴别出genymotion、bluestacks等主流模拟器。</p>
<h3 id="5-写在最后"><a href="#5-写在最后" class="headerlink" title="5.写在最后"></a>5.写在最后</h3><p>其实很多时候在检测模拟器的过程中，都不是只使用某一种固定的方法，一来需要具体问题具体分析，二来也需要用多种方法来综合检测。言而总之，有了十八般武艺才能见招拆招。</p>
<p>ps：如有错误或需要补充的地方，请各位多多指正～</p>
<p>————————————————<br>版权声明：本文为CSDN博主「江城的程序员大叔」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/sinat_33150417/article/details/51320228">https://blog.csdn.net/sinat_33150417/article/details/51320228</a></p>
<h2 id="ISCC2021-Analysis"><a href="#ISCC2021-Analysis" class="headerlink" title="ISCC2021-Analysis"></a>ISCC2021-Analysis</h2><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p><img src="./images/BUUCTF-RE-0x05/20210513193140.png" alt="image-20210513193130622"></p>
<p>然后下载后IDA去查看。</p>
<h3 id="查壳-2"><a href="#查壳-2" class="headerlink" title="查壳"></a>查壳</h3><p>发现没有壳，真好。。哈哈哈哈</p>
<p><img src="./images/BUUCTF-RE-0x05/20210513193512.png" alt="image-20210513193511484"></p>
<p>使用IDA32打开看看。</p>
<p>然后分析如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> Str[<span class="number">3</span>]; <span class="comment">// [esp+11h] [ebp-97h] BYREF</span></span><br><span class="line">  _BYTE v5[<span class="number">57</span>]; <span class="comment">// [esp+14h] [ebp-94h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [esp+4Dh] [ebp-5Bh]</span></span><br><span class="line">  <span class="keyword">char</span> v7[<span class="number">64</span>]; <span class="comment">// [esp+51h] [ebp-57h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v8[<span class="number">7</span>]; <span class="comment">// [esp+91h] [ebp-17h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [esp+98h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+9Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, <span class="number">4</span> * (((Str - v5 + <span class="number">64</span>) &amp; <span class="number">0xFFFFFFFC</span>) &gt;&gt; <span class="number">2</span>));</span><br><span class="line">  Str[<span class="number">0</span>] = <span class="number">67</span>;</span><br><span class="line">  Str[<span class="number">1</span>] = <span class="number">223</span>;</span><br><span class="line">  Str[<span class="number">2</span>] = <span class="number">20</span>;</span><br><span class="line">  v5[<span class="number">0</span>] = <span class="number">3</span>;</span><br><span class="line">  v5[<span class="number">1</span>] = <span class="number">13</span>;</span><br><span class="line">  v5[<span class="number">2</span>] = <span class="number">44</span>;</span><br><span class="line">  v5[<span class="number">3</span>] = <span class="number">9</span>;</span><br><span class="line">  v5[<span class="number">4</span>] = <span class="number">1</span>;</span><br><span class="line">  v5[<span class="number">5</span>] = <span class="number">23</span>;</span><br><span class="line">  v5[<span class="number">6</span>] = <span class="number">23</span>;</span><br><span class="line">  v5[<span class="number">7</span>] = <span class="number">8</span>;</span><br><span class="line">  v5[<span class="number">8</span>] = <span class="number">252</span>;</span><br><span class="line">  v5[<span class="number">9</span>] = <span class="number">43</span>;</span><br><span class="line">  v5[<span class="number">10</span>] = <span class="number">250</span>;</span><br><span class="line">  v5[<span class="number">11</span>] = <span class="number">20</span>;</span><br><span class="line">  v5[<span class="number">12</span>] = <span class="number">23</span>;</span><br><span class="line">  v5[<span class="number">13</span>] = <span class="number">249</span>;</span><br><span class="line">  v5[<span class="number">14</span>] = <span class="number">37</span>;</span><br><span class="line">  v5[<span class="number">15</span>] = <span class="number">245</span>;</span><br><span class="line">  v5[<span class="number">16</span>] = <span class="number">34</span>;</span><br><span class="line">  v5[<span class="number">17</span>] = <span class="number">61</span>;</span><br><span class="line">  v5[<span class="number">18</span>] = <span class="number">206</span>;</span><br><span class="line">  v5[<span class="number">19</span>] = <span class="number">24</span>;</span><br><span class="line">  v5[<span class="number">20</span>] = <span class="number">22</span>;</span><br><span class="line">  v5[<span class="number">21</span>] = <span class="number">10</span>;</span><br><span class="line">  <span class="built_in">qmemcpy</span>(v8, <span class="string">&quot;REVERSE&quot;</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(v8));           <span class="comment">// v8 = REVERSE</span></span><br><span class="line">  v9 = <span class="built_in">strlen</span>(Str);                             <span class="comment">// v9 = 25</span></span><br><span class="line">  <span class="built_in">printf</span>(Format);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, v7);</span><br><span class="line">  <span class="built_in">mix</span>(v7, v8, v9);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v9; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v7[i] != Str[i] )                      <span class="comment">// v7[i] == Str[i]</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(Buffer);                             <span class="comment">// 错误</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(aFlag);                                  <span class="comment">// 正确</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>mix(v7, v8, v9);</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">mix</span><span class="params">(<span class="keyword">char</span> *v7, <span class="keyword">char</span> *v8, <span class="keyword">int</span> v9)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v3; <span class="comment">// dl</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [esp+14h] [ebp-24h]</span></span><br><span class="line">  <span class="keyword">int</span> n; <span class="comment">// [esp+18h] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> m; <span class="comment">// [esp+1Ch] [ebp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> l; <span class="comment">// [esp+20h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">size_t</span> k; <span class="comment">// [esp+24h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [esp+28h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+2Ch] [ebp-Ch]</span></span><br><span class="line">                                                <span class="comment">// 目的：逆向出v7</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v9; ++i )                    <span class="comment">// v8[7] = RESERVE</span></span><br><span class="line">                                                <span class="comment">// v9 疑似25</span></span><br><span class="line">    v7[i] -= <span class="number">64</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v9; ++j )</span><br><span class="line">    v7[j] -= v7[j + <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="built_in">strlen</span>(v8); ++k )</span><br><span class="line">    v8[k] %= <span class="number">64</span>;                                <span class="comment">// 后面的v8都要改变</span></span><br><span class="line">  <span class="keyword">for</span> ( l = <span class="number">0</span>; l &lt; v9; ++l )</span><br><span class="line">    v7[l] += v8[l % <span class="number">7</span>];</span><br><span class="line">  <span class="keyword">for</span> ( m = <span class="number">0</span>; v9 / <span class="number">2</span> &gt; m; ++m )                <span class="comment">// 翻转</span></span><br><span class="line">  &#123;</span><br><span class="line">    v5 = v7[m];</span><br><span class="line">    v7[m] = v7[v9 - m - <span class="number">1</span>];</span><br><span class="line">    v7[v9 - m - <span class="number">1</span>] = v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( n = <span class="number">0</span>; ; ++n )</span><br><span class="line">  &#123;</span><br><span class="line">    result = n;</span><br><span class="line">    <span class="keyword">if</span> ( n &gt;= v9 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (v8[n % <span class="number">7</span>] &amp; <span class="number">1</span>) != <span class="number">0</span> )                 <span class="comment">// v8[i] != 0  -&gt; v7[i] +2</span></span><br><span class="line">                                                <span class="comment">// v8[i] == 0  -&gt; v7[i] +1</span></span><br><span class="line">      v3 = v7[n] + <span class="number">2</span>;                           <span class="comment">// v7[i] +2</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v3 = v7[n] + <span class="number">1</span>;</span><br><span class="line">    v7[n] = v3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="re"><a href="#re" class="headerlink" title="re"></a>re</h3><p>然后写出自己的逆向算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">v7A=[<span class="number">67</span>,-<span class="number">33</span>,<span class="number">20</span>,<span class="number">3</span>,<span class="number">13</span>,<span class="number">44</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">23</span>,<span class="number">23</span>,<span class="number">8</span>,-<span class="number">4</span>,<span class="number">43</span>,-<span class="number">6</span>,<span class="number">20</span>,<span class="number">23</span>,-<span class="number">7</span>,<span class="number">37</span>,-<span class="number">11</span>,<span class="number">34</span>,<span class="number">61</span>,-<span class="number">50</span>,<span class="number">24</span>,<span class="number">22</span>,<span class="number">10</span>]</span><br><span class="line"><span class="comment"># print(len(v7A))</span></span><br><span class="line"><span class="comment"># v7A = [67,223,20,3,13,44,9,1,23,23,8,252,43,250,20,23,249,37,245,34,61,206,24,22,10]</span></span><br><span class="line"><span class="comment"># v8 = &quot;RESERVE&quot;</span></span><br><span class="line"><span class="comment"># v8l = [R,E,S,E,R,V,E]</span></span><br><span class="line">v8s = <span class="string">&quot;REVERSE&quot;</span></span><br><span class="line">v8l = <span class="built_in">list</span>(v8s)</span><br><span class="line"><span class="built_in">print</span>(v8l)</span><br><span class="line">v8 =[]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;v81=&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v8l)):</span><br><span class="line">    v8.append(<span class="built_in">ord</span>(v8l[i])%<span class="number">64</span>);</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">ord</span>(v8l[i]), end=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;v8=&quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(v8)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">25</span>):</span><br><span class="line">    <span class="keyword">if</span> ((v8[i % <span class="number">7</span>] &amp; <span class="number">1</span>) != <span class="number">0</span>):</span><br><span class="line">        <span class="comment"># v3 = v7A[i] - 2;</span></span><br><span class="line">        v7A[i] -= <span class="number">2</span> ;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># v3 = v7A[i] - 1;</span></span><br><span class="line">        v7A[i] -= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(v7A) ;</span><br><span class="line">v7A.reverse()</span><br><span class="line">v9 = <span class="built_in">len</span>(v7A)</span><br><span class="line"><span class="comment"># for i in range(0,int(v9/2)):</span></span><br><span class="line"><span class="comment">#     temp = v7A[i];</span></span><br><span class="line"><span class="comment">#     v7A[i] = v7A[v9-i-1]</span></span><br><span class="line"><span class="comment">#     v7A[v9-i-1]  = temp ;</span></span><br><span class="line"><span class="comment"># print(&quot;v7A=&quot;,end=&#x27;&#x27;)</span></span><br><span class="line"><span class="built_in">print</span>(v7A)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">25</span>):</span><br><span class="line">    v7A[i] -= v8[i % <span class="number">7</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    v7A[i] += v7A[i+<span class="number">1</span>]</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(v7A)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v7A)):</span><br><span class="line">    v7A[i] += <span class="number">64</span></span><br><span class="line">    flag+=<span class="built_in">chr</span>(v7A[i])</span><br><span class="line"><span class="built_in">print</span>(v7A)</span><br><span class="line"><span class="comment"># [75, 85, 70, 67, 123, 82, 71, 88, 71, 85, 83, 69, 95, 75, 85, 97, 81, 79, 84, 95, 74, 67, 84, 71, 125]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># a=&quot;ISCC&quot;</span></span><br><span class="line"><span class="comment"># 73,83,67,67,</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># ISCC&#123;REVERSE_IS_NOT_HARD&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Youngter-drive"><a href="#Youngter-drive" class="headerlink" title="Youngter-drive"></a>Youngter-drive</h2><h3 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h3><p><img src="./images/BUUCTF-RE-0x05/20210513173953.png" alt="image-20210513173952015"></p>
<p>开始以为是按照题目的提示会有什么解题的方法，然后没有发现。</p>
<p>下载下来是一个EXE的 ==PE== 文件。<a target="_blank" rel="noopener" href="https://files.buuoj.cn/files/cc82fafd07956c7884bd125d2924ca84/7289daa8-a5d5-430e-87a0-92ce805d8f15.zip?token=eyJ1c2VyX2lkIjoxOTIwMiwidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6MTU3fQ.YJzz3w.15XyJNZs7NgjujVxpBSbZ219lQQ">下载</a></p>
<h3 id="查壳-3"><a href="#查壳-3" class="headerlink" title="查壳"></a>查壳</h3><p>传统的查壳步骤。</p>
<p><img src="./images/BUUCTF-RE-0x05/20210513174514.png" alt="Exeinfo查壳"></p>
<p><img src="./images/BUUCTF-RE-0x05/20210513174602.png" alt="DIE查壳"></p>
<p>然后准备使用OD和x64手脱，但是发现好像有点问题。脱不了，因为缺少一个运行库。初步怀疑是文件下载后丢失的。所以就使用UPX脱壳机完成脱壳。</p>
<p><img src="./images/BUUCTF-RE-0x05/20210513174926.png" alt="image-20210513174924275"></p>
<p>看见是32位的软件，所以就不动态调试了。直接IDA32然后打开。</p>
<h3 id="分析-1"><a href="#分析-1" class="headerlink" title="分析"></a>分析</h3><p>找了一会儿，然后找到主函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main_0</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">void</span> *v3; <span class="comment">// ecx</span></span><br><span class="line">  HANDLE v5; <span class="comment">// [esp+D0h] [ebp-14h]</span></span><br><span class="line">  HANDLE hObject; <span class="comment">// [esp+DCh] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">sub_4110FF</span>(v3);</span><br><span class="line">  ::hObject = <span class="built_in">CreateMutexW</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">j_strcpy</span>(Destination, Source);</span><br><span class="line">  hObject = <span class="built_in">CreateThread</span>(<span class="number">0</span>, <span class="number">0</span>, StartAddress, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  v5 = <span class="built_in">CreateThread</span>(<span class="number">0</span>, <span class="number">0</span>, sub_41119F, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">CloseHandle</span>(hObject);</span><br><span class="line">  <span class="built_in">CloseHandle</span>(v5);</span><br><span class="line">  <span class="keyword">while</span> ( dword_418008 != <span class="number">-1</span> )</span><br><span class="line">    ;</span><br><span class="line">  <span class="built_in">sub_411190</span>();</span><br><span class="line">  <span class="built_in">CloseHandle</span>(::hObject);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后发现整个主要是在第一个函数和后面的两个函数来进行处理。</p>
<p>然后有两个线程来进行调用。</p>
<p><img src="./images/BUUCTF-RE-0x05/20210513175505.png" alt="image-20210513175504485"></p>
<p>然后发现只有29个的样子。</p>
<h3 id="网上的方法"><a href="#网上的方法" class="headerlink" title="网上的方法"></a>网上的方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">flagpart = <span class="string">&#x27;TOiZiZtOrYaToUwPnToBsOaOapsyS&#x27;</span></span><br><span class="line">flagrange = <span class="string">&#x27;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flagpart)):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        flag += flagpart[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> flagpart[i].isupper():</span><br><span class="line">            flag += <span class="built_in">chr</span>(flagrange.find(flagpart[i]) + <span class="number">96</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag += <span class="built_in">chr</span>(flagrange.find(flagpart[i]) + <span class="number">38</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;&quot;</span>+flag+<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(flag))</span><br></pre></td></tr></table></figure>

<p>然后就继续看WP发现是随便一位都可以，然后看见是E</p>
<p><img src="./images/BUUCTF-RE-0x05/20210513175843.png" alt="image-20210513175842039"></p>
<h3 id="WP"><a href="#WP" class="headerlink" title="WP"></a>WP</h3><p><a target="_blank" rel="noopener" href="https://hx1997.github.io/2018/07/22/anheng-july-re-youngter-drive/">详解</a></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>了解了多线程的实际运用了，然后对于多线程的解法有点懂了。</p>
<h1 id="END"><a href="#END" class="headerlink" title="END~"></a>END~</h1>
    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Snow
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/" title="BUUCTF-RE-0x05">https://angelsnow1129.github/2021/06/06/BUUCTF-RE-0x05/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">春花秋月，夏荷冬雪。</div>
    
</div>
  
</div>

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/06/06/hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%EF%BC%88NEXT%E7%BE%8E%E5%8C%96%EF%BC%89%E2%80%94%E2%80%94%E7%AE%80%E7%95%A5/" rel="prev" title="hexo博客搭建（NEXT美化）——简略">
      <i class="fa fa-chevron-left"></i> hexo博客搭建（NEXT美化）——简略
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/06/06/OPENVINO-1-%E8%A7%86%E9%A2%91%E5%A4%84%E7%90%86-OpenVINO-%E2%84%A2%E4%BB%8B%E7%BB%8D/" rel="next" title="OPENVINO-1:视频处理 & OpenVINO ™介绍">
      OPENVINO-1:视频处理 & OpenVINO ™介绍 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">


      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#BUUCTF%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95"><span class="nav-number">1.</span> <span class="nav-text">BUUCTF刷题记录</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-rome"><span class="nav-number">1.1.</span> <span class="nav-text">[ACTF新生赛2020]rome</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E8%AF%A6%E6%83%85"><span class="nav-number">1.1.1.</span> <span class="nav-text">题目详情</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E5%A3%B3"><span class="nav-number">1.1.2.</span> <span class="nav-text">查壳</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flag"><span class="nav-number">1.1.3.</span> <span class="nav-text">flag</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#FlareOn4-login"><span class="nav-number">1.2.</span> <span class="nav-text">[FlareOn4]login</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE"><span class="nav-number">1.2.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#login-html-%E6%BA%90%E7%A0%81"><span class="nav-number">1.2.2.</span> <span class="nav-text">login.html 源码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%9E%90"><span class="nav-number">1.2.3.</span> <span class="nav-text">分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flag-1"><span class="nav-number">1.2.4.</span> <span class="nav-text">flag</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">1.2.5.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GUET-CTF2019-re"><span class="nav-number">1.3.</span> <span class="nav-text">[GUET-CTF2019]re</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0"><span class="nav-number">1.3.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E5%A3%B3-1"><span class="nav-number">1.3.2.</span> <span class="nav-text">查壳</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B9%E5%90%8Eflag"><span class="nav-number">1.3.3.</span> <span class="nav-text">改后flag</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Android%E6%A8%A1%E6%8B%9F%E5%99%A8%E6%A3%80%E6%B5%8B%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="nav-number">1.4.</span> <span class="nav-text">Android模拟器检测常用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E4%BC%A0%E7%BB%9F%E7%9A%84%E6%A3%80%E6%B5%8B%E6%96%B9%E6%B3%95%E3%80%82"><span class="nav-number">1.4.1.</span> <span class="nav-text">1.传统的检测方法。</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E9%BB%98%E8%AE%A4%E5%8F%B7%E7%A0%81%EF%BC%9A"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">（1）默认号码：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E9%BB%98%E8%AE%A4ID%EF%BC%9A"><span class="nav-number">1.4.1.2.</span> <span class="nav-text">（2）默认ID：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E9%BB%98%E8%AE%A4IMSI%EF%BC%9A"><span class="nav-number">1.4.1.3.</span> <span class="nav-text">（3）默认IMSI：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%884%EF%BC%89%E9%BB%98%E8%AE%A4%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%EF%BC%9A"><span class="nav-number">1.4.1.4.</span> <span class="nav-text">（4）默认文件路径：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%9F%BA%E4%BA%8E%E6%A8%A1%E6%8B%9F%E5%99%A8cpu%E4%BF%A1%E6%81%AF%E7%9A%84%E6%A3%80%E6%B5%8B%E3%80%82"><span class="nav-number">1.4.2.</span> <span class="nav-text">2.基于模拟器cpu信息的检测。</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E8%AF%BB%E5%8F%96cpu%E4%BF%A1%E6%81%AF%EF%BC%9A"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">（1）读取cpu信息：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E8%BF%9B%E8%A1%8C%E5%88%A4%E5%AE%9A%EF%BC%9A"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">（2）进行判定：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E5%85%B3%E9%94%AE%E8%B7%AF%E5%BE%84%E6%A3%80%E6%B5%8B%E7%89%B9%E5%AE%9A%E6%A8%A1%E6%8B%9F%E5%99%A8%E6%A3%80%E6%B5%8B"><span class="nav-number">1.4.3.</span> <span class="nav-text">3.关键路径检测特定模拟器检测</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A3%80%E6%B5%8B%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">检测方法：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E6%A8%A1%E6%8B%9F%E5%99%A8%E6%A3%80%E6%B5%8B%E6%96%B0%E6%80%9D%E8%B7%AF"><span class="nav-number">1.4.4.</span> <span class="nav-text">4.模拟器检测新思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E"><span class="nav-number">1.4.5.</span> <span class="nav-text">5.写在最后</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ISCC2021-Analysis"><span class="nav-number">1.5.</span> <span class="nav-text">ISCC2021-Analysis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0"><span class="nav-number">1.5.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E5%A3%B3-2"><span class="nav-number">1.5.2.</span> <span class="nav-text">查壳</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#re"><span class="nav-number">1.5.3.</span> <span class="nav-text">re</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Youngter-drive"><span class="nav-number">1.6.</span> <span class="nav-text">Youngter-drive</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6"><span class="nav-number">1.6.1.</span> <span class="nav-text">文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E5%A3%B3-3"><span class="nav-number">1.6.2.</span> <span class="nav-text">查壳</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%9E%90-1"><span class="nav-number">1.6.3.</span> <span class="nav-text">分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E4%B8%8A%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">1.6.4.</span> <span class="nav-text">网上的方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WP"><span class="nav-number">1.6.5.</span> <span class="nav-text">WP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">1.6.6.</span> <span class="nav-text">总结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#END"><span class="nav-number">2.</span> <span class="nav-text">END~</span></a></li></ol></div>

      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Snow"
      src="/images/AS.jpg">
  <p class="site-author-name" itemprop="name">Snow</p>
  <div class="site-description" itemprop="description">Hope, Marvel, Youth.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">22</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    来撩
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/angelsnow1129" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;angelsnow1129" rel="noopener" target="_blank"><i class="fa fa-fw fa-fab fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:angelsnow1129@163.com" title="E-Mail → mailto:angelsnow1129@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-fa fa-envelope"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      友链
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="/T" title="T">0</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/i" title="i">1</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/t" title="t">2</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/l" title="l">3</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/e" title="e">4</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/:" title=":">5</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/h" title="h">6</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/t" title="t">7</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/t" title="t">8</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/p" title="p">9</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/s" title="s">10</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/:" title=":">11</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/" title="&#x2F;">12</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/" title="&#x2F;">13</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/p" title="p">14</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/a" title="a">15</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/n" title="n">16</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/d" title="d">17</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/a" title="a">18</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/0" title="0">19</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/s" title="s">20</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/." title=".">21</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/t" title="t">22</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/o" title="o">23</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/p" title="p">24</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/" title="&#x2F;">25</a>
        </li>
    </ul>
  </div>


  <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=110 src="//music.163.com/outchain/player?type=0&id=6671522046&auto=1&height=90"></iframe>
      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2020 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Snow</span>
</div>


<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>  
<br>北岛有诗，南岛有梦。</br>

<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("04/18/2021 01:11:29");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
setInterval("createtime()",250);
</script>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>
    <script defer src="/lib/three/canvas_sphere.min.js"></script>


  















    <div id="pjax">
  

  

    </div>
</body>
</html>
